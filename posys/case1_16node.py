#!/usr/bin/env python
# -*- coding: utf-8 -*-

### From Cyclone via Francsico de Leon on May 5, 2016
### Translated to python by Greg Dobler (CUSP/NYU)
#
##CASE1_16node  Power flow data for 16 nodes meshed distribution system.
##Network Transformer are located at nodes 5, 14, 3 
#
### MATPOWER Case Format : Version 2
### GGD: is this necessary?
##mpc.version = '2';
#

import numpy as np

def cyclone_ppc():

    # -- GGD: initialize ppc
    ppc = {}


    ##-----  Power Flow Data  -----##
    ## system MVA base
    ppc["baseMVA"] = 10;

    ## bus data
    #       bus_i   type    Pd      Qd      Gs      Bs      area    Vm      Va      baseKV  zone    Vmax    Vmin
    ppc["bus"] = np.array([
        [1,   1,  0,  0,  0.50,  0.399,  1,  1,  0,  0.4,  1,  1.1,  0.9],
        [2,   1,  0,  0,  0.70,  0.335,  1,  1,  0,  0.4,  1,  1.1,  0.9],
        [3,   3,  0,  0,  0.00,  0.000,  1,  1,  0,  0.4,  1,  1.1,  0.9],
        [4,   1,  0,  0,  1.80,  0.458,  1,  1,  0,  0.4,  1,  1.1,  0.9],
        [5,   3,  0,  0,  0.00,  0.000,  1,  1,  0,  0.4,  1,  1.1,  0.9],
        [6,   1,  0,  0,  0.40,  0.356,  1,  1,  0,  0.4,  1,  1.1,  0.9],
        [7,   1,  0,  0,  0.50,  0.277,  1,  1,  0,  0.4,  1,  1.1,  0.9],
        [8,   1,  0,  0,  0.80,  0.189,  1,  1,  0,  0.4,  1,  1.1,  0.9],
        [9,   1,  0,  0,  1.30,  0.599,  1,  1,  0,  0.4,  1,  1.1,  0.9],
        [10,  1,  0,  0,  0.20,  0.149,  1,  1,  0,  0.4,  1,  1.1,  0.9],
        [11,  1,  0,  0,  0.00,  0.099,  1,  1,  0,  0.4,  1,  1.1,  0.9],
        [12,  1,  0,  0,  0.20,  0.066,  1,  1,  0,  0.4,  1,  1.1,  0.9],
        [13,  1,  0,  0,  0.50,  0.223,  1,  1,  0,  0.4,  1,  1.1,  0.9],
        [14,  3,  0,  0,  0.00,  0.000,  1,  1,  0,  0.4,  1,  1.1,  0.9],
        [15,  1,  0,  0,  0.90,  0.029,  1,  1,  0,  0.4,  1,  1.1,  0.9],
        [16,  1,  0,  0,  1.70,  0.429,  1,  1,  0,  0.4,  1,  1.1,  0.9],
    ])

    ## generator data
    #       bus     Pg      Qg      Qmax    Qmin    Vg      mBase   status  Pmax    Pmin    Pc1     Pc2     Qc1min  Qc1max  Qc2min  Qc2max  ramp_agc        ramp_10 ramp_30 ramp_q  apf
    ppc["gen"] = np.array([
        [3,   31,  0,  100,  -100,  1.00,   100,  1,  50,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0],
        [5,   0,   0,  100,  -100,  1.00,   100,  1,  0,   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0],
        [14,  0,   0,  100,  -100,  1.005,  100,  1,  0,   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0],
    ])

    ## branch data
    #       fbus    tbus    r       x       b       rateA   rateB   rateC   ratio   angle   status  angmin  angmax
    ppc["branch"] = np.array([
        [1,   2,   0.02008,  0.01904,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [1,   5,   0.04744,  0.01972,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [2,   3,   0.01744,  0.02372,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [2,   6,   0.00872,  0.01436,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [3,   4,   0.01227,  0.01936,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [3,   7,   0.01527,  0.01136,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [4,   8,   0.02127,  0.01236,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [5,   6,   0.02227,  0.01436,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [5,   9,   0.01327,  0.00936,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [6,   7,   0.01527,  0.00836,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [6,   10,  0.01627,  0.01136,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [7,   8,   0.01627,  0.02336,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [7,   11,  0.01427,  0.01436,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [8,   12,  0.02327,  0.01536,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [9,   10,  0.00627,  0.01636,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [9,   13,  0.07427,  0.01336,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [10,  11,  0.04327,  0.01436,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [10,  14,  0.06727,  0.01636,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [11,  12,  0.03827,  0.01736,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [11,  15,  0.03927,  0.03636,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [12,  16,  0.01127,  0.01136,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [13,  14,  0.01227,  0.01236,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [14,  15,  0.05272,  0.01236,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
        [15,  16,  0.04273,  0.02936,  0.001,  25,  25,  25,  0,  0,  1,  -360,  360],
    ])


    # -- return the system
    return ppc
